#!/bin/sh -e

mkdir -p te_hubbard_chain_interall_diagonal/
cd te_hubbard_chain_interall_diagonal
python3 "$1/test/testTECalc.py" -p "../../src/HPhi" -mpi "${MPIRUN}" -t "Diagonal"

# Check value: flct
cat > reference.dat <<EOF
0.0000000000000000 4.0000000000000009 16.0000000000000036 0.2873253726900541 0.3082093228771928 0.0000000000000000 0.0000000000000000 0
0.0100000000000000 4.0000000000000018 16.0000000000000071 0.2872642876709242 0.3081437979560633 0.0000000000000000 0.0000000000000000 1
0.0200000000000000 4.0000000000000000 16.0000000000000000 0.2867980368998106 0.3076731059472225 0.0000000000000000 0.0000000000000000 2
0.0300000000000000 4.0000000000000027 16.0000000000000107 0.2859278721339427 0.3067984888269745 0.0000000000000000 0.0000000000000000 3
0.0400000000000000 4.0000000000000018 16.0000000000000071 0.2846576273386550 0.3055232490946924 0.0000000000000000 0.0000000000000000 4
0.0500000000000000 3.9999999999999996 15.9999999999999982 0.2829937034061020 0.3038527391163992 0.0000000000000000 0.0000000000000000 5
0.0600000000000000 4.0000000000000000 16.0000000000000000 0.2809450326982136 0.3017943413372993 0.0000000000000000 0.0000000000000000 6
0.0700000000000000 4.0000000000000009 16.0000000000000036 0.2785230235978054 0.2993574394149863 0.0000000000000000 0.0000000000000000 7
0.0800000000000000 3.9999999999999987 15.9999999999999947 0.2757414854381574 0.2965533803233275 0.0000000000000000 0.0000000000000000 8
0.0900000000000000 3.9999999999999996 15.9999999999999982 0.2726165343653628 0.2933954274757609 0.0000000000000000 0.0000000000000000 9
0.1000000000000000 3.9999999999999987 15.9999999999999947 0.2691664808672899 0.2898987049169202 0.0000000000000000 0.0000000000000000 10
0.1100000000000000 4.0000000000000000 16.0000000000000000 0.2654116998760684 0.2860801326340390 0.0000000000000000 0.0000000000000000 11
0.1200000000000000 4.0000000000000009 16.0000000000000036 0.2613744845156407 0.2819583530453394 0.0000000000000000 0.0000000000000000 12
0.1300000000000000 4.0000000000000018 16.0000000000000071 0.2570788847202646 0.2775536487324475 0.0000000000000000 0.0000000000000000 13
0.1400000000000000 4.0000000000000027 16.0000000000000107 0.2525505320921335 0.2728878514984943 0.0000000000000000 0.0000000000000000 14
0.1500000000000000 4.0000000000000018 16.0000000000000071 0.2478164524948830 0.2679842428536327 0.0000000000000000 0.0000000000000000 15
0.1600000000000000 3.9999999999999987 15.9999999999999947 0.2429048679932180 0.2628674460557298 0.0000000000000000 0.0000000000000000 16
0.1700000000000000 4.0000000000000009 16.0000000000000036 0.2378449898459161 0.2575633098663856 0.0000000000000000 0.0000000000000000 17
0.1800000000000000 4.0000000000000027 16.0000000000000107 0.2326668043389582 0.2520987842214426 0.0000000000000000 0.0000000000000000 18
0.1900000000000000 4.0000000000000009 16.0000000000000036 0.2274008533066207 0.2465017880608708 0.0000000000000000 0.0000000000000000 19
0.2000000000000000 4.0000000000000018 16.0000000000000071 0.2220780112303574 0.2408010696152935 0.0000000000000000 0.0000000000000000 20
0.2100000000000000 4.0000000000000018 16.0000000000000071 0.2167292608277797 0.2350260595052210 0.0000000000000000 0.0000000000000000 21
0.2200000000000000 3.9999999999999991 15.9999999999999964 0.2113854690468136 0.2292067170739058 0.0000000000000000 0.0000000000000000 22
0.2300000000000000 3.9999999999999991 15.9999999999999964 0.2060771653632077 0.2233733704450429 0.0000000000000000 0.0000000000000000 23
0.2400000000000000 3.9999999999999987 15.9999999999999947 0.2008343242432714 0.2175565508716097 0.0000000000000000 0.0000000000000000 24
0.2500000000000000 4.0000000000000000 16.0000000000000000 0.1956861535785657 0.2117868220210748 0.0000000000000000 0.0000000000000000 25
0.2600000000000000 4.0000000000000000 16.0000000000000000 0.1906608908259888 0.2060946049240042 0.0000000000000000 0.0000000000000000 26
0.2700000000000000 3.9999999999999978 15.9999999999999911 0.1857856084962640 0.2005099993965630 0.0000000000000000 0.0000000000000000 27
0.2800000000000000 4.0000000000000000 16.0000000000000000 0.1810860305274384 0.1950626028313243 0.0000000000000000 0.0000000000000000 28
0.2900000000000000 4.0000000000000018 16.0000000000000071 0.1765863609589813 0.1897813273337317 0.0000000000000000 0.0000000000000000 29
0.3000000000000000 4.0000000000000000 16.0000000000000000 0.1723091261880040 0.1846942162621100 0.0000000000000000 0.0000000000000000 30
0.3100000000000000 3.9999999999999996 15.9999999999999982 0.1682750319436508 0.1798282613057280 0.0000000000000000 0.0000000000000000 31
0.3200000000000000 3.9999999999999987 15.9999999999999947 0.1645028359607191 0.1752092213065835 0.0000000000000000 0.0000000000000000 32
0.3300000000000000 4.0000000000000009 16.0000000000000036 0.1610092371709078 0.1708614440947241 0.0000000000000000 0.0000000000000000 33
0.3400000000000000 4.0000000000000027 16.0000000000000107 0.1578087820618363 0.1668076926625204 0.0000000000000000 0.0000000000000000 34
0.3500000000000000 4.0000000000000009 16.0000000000000036 0.1549137886821114 0.1630689770488716 0.0000000000000000 0.0000000000000000 35
0.3600000000000000 3.9999999999999978 15.9999999999999911 0.1523342885973732 0.1596643933384461 0.0000000000000000 0.0000000000000000 36
0.3700000000000000 4.0000000000000009 16.0000000000000036 0.1500779869294499 0.1566109712024009 0.0000000000000000 0.0000000000000000 37
0.3800000000000000 3.9999999999999973 15.9999999999999893 0.1481502404405489 0.1539235314143972 0.0000000000000000 0.0000000000000000 38
0.3900000000000000 4.0000000000000009 16.0000000000000036 0.1465540534587749 0.1516145547681019 0.0000000000000000 0.0000000000000000 39
0.4000000000000000 4.0000000000000000 16.0000000000000000 0.1452900912820645 0.1496940637988078 0.0000000000000000 0.0000000000000000 40
0.4100000000000000 3.9999999999999987 15.9999999999999947 0.1443567105466417 0.1481695186717032 0.0000000000000000 0.0000000000000000 41
0.4200000000000000 4.0000000000000000 16.0000000000000000 0.1437500059049477 0.1470457285421160 0.0000000000000000 0.0000000000000000 42
0.4300000000000000 4.0000000000000000 16.0000000000000000 0.1434638722281505 0.1463247796185615 0.0000000000000000 0.0000000000000000 43
0.4400000000000000 4.0000000000000009 16.0000000000000036 0.1434900814310930 0.1460059810675748 0.0000000000000000 0.0000000000000000 44
0.4500000000000000 3.9999999999999982 15.9999999999999929 0.1438183729139682 0.1460858297903531 0.0000000000000000 0.0000000000000000 45
0.4600000000000000 4.0000000000000009 16.0000000000000036 0.1444365565260280 0.1465579949756637 0.0000000000000000 0.0000000000000000 46
0.4700000000000000 3.9999999999999987 15.9999999999999947 0.1453306268828724 0.1474133231919952 0.0000000000000000 0.0000000000000000 47
0.4800000000000000 4.0000000000000000 16.0000000000000000 0.1464848878108026 0.1486398646255710 0.0000000000000000 0.0000000000000000 48
0.4900000000000000 4.0000000000000009 16.0000000000000036 0.1478820856495274 0.1502229209007971 0.0000000000000000 0.0000000000000000 49
0.5000000000000000 4.0000000000000009 16.0000000000000036 0.1495035501182036 0.1521451147375006 0.0000000000000000 0.0000000000000000 50
0.5100000000000000 4.0000000000000009 16.0000000000000036 0.1513293414390885 0.1543864815065780 0.0000000000000000 0.0000000000000000 51
0.5200000000000000 4.0000000000000000 16.0000000000000000 0.1533384024175427 0.1569245825443664 0.0000000000000000 0.0000000000000000 52
0.5300000000000000 3.9999999999999982 15.9999999999999929 0.1555087141960507 0.1597346398782222 0.0000000000000000 0.0000000000000000 53
0.5400000000000000 4.0000000000000000 16.0000000000000000 0.1578174544324659 0.1627896918037305 0.0000000000000000 0.0000000000000000 54
0.5500000000000000 3.9999999999999987 15.9999999999999947 0.1602411566977628 0.1660607685400317 0.0000000000000000 0.0000000000000000 55
0.5600000000000001 3.9999999999999991 15.9999999999999964 0.1627558699450030 0.1695170869764597 0.0000000000000000 0.0000000000000000 56
0.5700000000000000 4.0000000000000000 16.0000000000000000 0.1653373169676060 0.1731262633135839 0.0000000000000000 0.0000000000000000 57
0.5800000000000000 3.9999999999999991 15.9999999999999964 0.1679610508399206 0.1768545421974681 0.0000000000000000 0.0000000000000000 58
0.5900000000000000 4.0000000000000000 16.0000000000000000 0.1706026084149304 0.1806670407500896 0.0000000000000000 0.0000000000000000 59
0.6000000000000000 3.9999999999999987 15.9999999999999947 0.1732376600410831 0.1845280057140168 0.0000000000000000 0.0000000000000000 60
0.6100000000000000 3.9999999999999987 15.9999999999999947 0.1758421547510409 0.1884010817581099 0.0000000000000000 0.0000000000000000 61
0.6200000000000000 3.9999999999999978 15.9999999999999911 0.1783924602679291 0.1922495888356227 0.0000000000000000 0.0000000000000000 62
0.6300000000000000 3.9999999999999991 15.9999999999999964 0.1808654972677715 0.1960368063489111 0.0000000000000000 0.0000000000000000 63
0.6400000000000000 3.9999999999999982 15.9999999999999929 0.1832388674286112 0.1997262617580901 0.0000000000000000 0.0000000000000000 64
0.6500000000000000 4.0000000000000000 16.0000000000000000 0.1854909748858243 0.2032820211763449 0.0000000000000000 0.0000000000000000 65
0.6600000000000000 3.9999999999999996 15.9999999999999982 0.1876011407978706 0.2066689794238186 0.0000000000000000 0.0000000000000000 66
0.6700000000000000 4.0000000000000000 16.0000000000000000 0.1895497108059015 0.2098531469665094 0.0000000000000000 0.0000000000000000 67
0.6800000000000000 4.0000000000000000 16.0000000000000000 0.1913181552430818 0.2128019311474784 0.0000000000000000 0.0000000000000000 68
0.6899999999999999 4.0000000000000009 16.0000000000000036 0.1928891620141794 0.2154844091257367 0.0000000000000000 0.0000000000000000 69
0.7000000000000000 4.0000000000000009 16.0000000000000036 0.1942467221220963 0.2178715899738826 0.0000000000000000 0.0000000000000000 70
0.7100000000000000 3.9999999999999987 15.9999999999999947 0.1953762078649533 0.2199366634490739 0.0000000000000000 0.0000000000000000 71
0.7200000000000000 4.0000000000000000 16.0000000000000000 0.1962644437646315 0.2216552330429945 0.0000000000000000 0.0000000000000000 72
0.7300000000000000 3.9999999999999982 15.9999999999999929 0.1968997703151385 0.2230055310345828 0.0000000000000000 0.0000000000000000 73
0.7400000000000000 4.0000000000000000 16.0000000000000000 0.1972721006567742 0.2239686134135067 0.0000000000000000 0.0000000000000000 74
0.7500000000000000 3.9999999999999991 15.9999999999999964 0.1973729702900326 0.2245285327114388 0.0000000000000000 0.0000000000000000 75
0.7600000000000000 4.0000000000000009 16.0000000000000036 0.1971955799419235 0.2246724869705510 0.0000000000000000 0.0000000000000000 76
0.7700000000000000 4.0000000000000000 16.0000000000000000 0.1967348316875238 0.2243909432923771 0.0000000000000000 0.0000000000000000 77
0.7800000000000000 3.9999999999999996 15.9999999999999982 0.1959873584118988 0.2236777346431321 0.0000000000000000 0.0000000000000000 78
0.7900000000000000 4.0000000000000000 16.0000000000000000 0.1949515466730235 0.2225301288412273 0.0000000000000000 0.0000000000000000 79
0.8000000000000000 4.0000000000000027 16.0000000000000107 0.1936275529961428 0.2209488689164219 0.0000000000000000 0.0000000000000000 80
0.8100000000000001 4.0000000000000000 16.0000000000000000 0.1920173135953778 0.2189381843048566 0.0000000000000000 0.0000000000000000 81
0.8200000000000000 3.9999999999999991 15.9999999999999964 0.1901245474807109 0.2165057726270709 0.0000000000000000 0.0000000000000000 82
0.8300000000000000 4.0000000000000018 16.0000000000000071 0.1879547528692164 0.2136627520837798 0.0000000000000000 0.0000000000000000 83
0.8400000000000000 3.9999999999999996 15.9999999999999982 0.1855151967800713 0.2104235847933885 0.0000000000000000 0.0000000000000000 84
0.8500000000000000 4.0000000000000000 16.0000000000000000 0.1828148976550341 0.2068059716825866 0.0000000000000000 0.0000000000000000 85
0.8600000000000000 4.0000000000000018 16.0000000000000071 0.1798646008112518 0.2028307198235313 0.0000000000000000 0.0000000000000000 86
0.8700000000000000 4.0000000000000027 16.0000000000000107 0.1766767465029847 0.1985215833847926 0.0000000000000000 0.0000000000000000 87
0.8800000000000000 4.0000000000000009 16.0000000000000036 0.1732654303445614 0.1939050796251372 0.0000000000000000 0.0000000000000000 88
0.8900000000000000 4.0000000000000009 16.0000000000000036 0.1696463558299621 0.1890102816062807 0.0000000000000000 0.0000000000000000 89
0.9000000000000000 4.0000000000000000 16.0000000000000000 0.1658367786761292 0.1838685895299930 0.0000000000000000 0.0000000000000000 90
0.9100000000000000 4.0000000000000009 16.0000000000000036 0.1618554427185075 0.1785134828136755 0.0000000000000000 0.0000000000000000 91
0.9200000000000000 4.0000000000000009 16.0000000000000036 0.1577225070993612 0.1729802552042549 0.0000000000000000 0.0000000000000000 92
0.9300000000000000 4.0000000000000009 16.0000000000000036 0.1534594645128290 0.1673057353907694 0.0000000000000000 0.0000000000000000 93
0.9399999999999999 4.0000000000000000 16.0000000000000000 0.1490890503060001 0.1615279957094650 0.0000000000000000 0.0000000000000000 94
0.9500000000000000 4.0000000000000018 16.0000000000000071 0.1446351422828017 0.1556860516400352 0.0000000000000000 0.0000000000000000 95
0.9600000000000000 3.9999999999999996 15.9999999999999982 0.1401226511172660 0.1498195548666412 0.0000000000000000 0.0000000000000000 96
0.9700000000000000 4.0000000000000009 16.0000000000000036 0.1355774013545736 0.1439684827217378 0.0000000000000000 0.0000000000000000 97
0.9800000000000000 4.0000000000000009 16.0000000000000036 0.1310260030617407 0.1381728268440928 0.0000000000000000 0.0000000000000000 98
0.9900000000000000 4.0000000000000018 16.0000000000000071 0.1264957142842115 0.1324722838647145 0.0000000000000000 0.0000000000000000 99
EOF
sed -e "1d" output/Flct.dat > flct.dat
paste flct.dat reference.dat > paste1.dat
diff=`awk 'BEGIN{diff=0.0} {diff+=sqrt(($2-$10)*($2-$10))} END{printf "%8.6f", diff}' paste1.dat`
diff=`awk 'BEGIN{diff='${diff}'} {diff+=sqrt(($3-$11)*($3-$11))} END{printf "%8.6f", diff}' paste1.dat`
diff=`awk 'BEGIN{diff='${diff}'} {diff+=sqrt(($4-$12)*($4-$12))} END{printf "%8.6f", diff}' paste1.dat`
diff=`awk 'BEGIN{diff='${diff}'} {diff+=sqrt(($5-$13)*($5-$13))} END{printf "%8.6f", diff}' paste1.dat`
diff=`awk 'BEGIN{diff='${diff}'} {diff+=sqrt(($6-$14)*($6-$14))} END{printf "%8.6f", diff}' paste1.dat`
diff=`awk 'BEGIN{diff='${diff}'} {diff+=sqrt(($7-$15)*($7-$15))} END{printf "%8.6f", diff}' paste1.dat`

test "${diff}" = "0.000000"
exit $?
