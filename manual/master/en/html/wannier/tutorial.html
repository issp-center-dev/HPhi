
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8.2. Tutorial &#8212; HΦ Documentation 3.5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="8.3. Input parameters for Standard mode" href="parameter.html" />
    <link rel="prev" title="8.1. Overview" href="overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<span id="tutorialwannier"></span><h1><span class="section-number">8.2. </span>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading">¶</a></h1>
<p>In this tutorial, we downfold Sr<sub>2</sub>CuO<sub>3</sub>
into single orbital 1D Hubbard model,
and simulate that model with HPhi/mVMC.
We use QuantumESPRESSO for the DFT calculation.
Input files are served in <code class="docutils literal notranslate"><span class="pre">samples/Wannier/Sr2CuO3</span></code> directory.</p>
<p>In actual studies, the input files etc. of each solver should be modified for more high accuracy calculation.
Please refer to the manuals of each solver for the details of the input files.</p>
<section id="scf-calculation-of-charge-density">
<h2><span class="section-number">8.2.1. </span>SCF calculation of charge density<a class="headerlink" href="#scf-calculation-of-charge-density" title="Permalink to this heading">¶</a></h2>
<p>First, we perform the SCF calculation of the charge density.
The input file is as follows:</p>
<p><a class="reference download internal" download="" href="../_downloads/fc8a03ca4d72a607207c9c468c338dd3/scf.in"><code class="xref download docutils literal notranslate"><span class="pre">scf.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;scf&#39;
  pseudo_dir = &#39;../pseudo&#39;
prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
 occupations = &#39;tetrahedra_opt&#39;
/
&amp;ELECTRONS
mixing_beta = 0.3
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS automatic
 4 4 4 0 0 0
</pre></div>
</div>
<p>The pseudopotential (UPF file) are downloaded from
<a class="reference external" href="www.quantum-simulation.org/potentials/sg15_oncv/">The SG15 Optimized Norm-Conserving Vanderbilt (ONCV) pseudopotentials</a>.
Put the pseudopotential files into <code class="docutils literal notranslate"><span class="pre">../pseudo</span></code> directory.</p>
<p><a class="reference external" href="http://www.quantum-simulation.org/potentials/sg15_oncv/sg15_oncv_upf_2015-10-07.tar.gz">http://www.quantum-simulation.org/potentials/sg15_oncv/sg15_oncv_upf_2015-10-07.tar.gz</a></p>
<p>We use the program <code class="docutils literal notranslate"><span class="pre">pw.x</span></code> in QuantumESPRESSO as follows.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in scf.in
</pre></div>
</div>
</section>
<section id="optional-band-structure">
<h2><span class="section-number">8.2.2. </span>(Optional) Band structure<a class="headerlink" href="#optional-band-structure" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/da167c3c214ea2b40788f448a3605d0b/band.in"><code class="xref download docutils literal notranslate"><span class="pre">band.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;bands&#39;
  pseudo_dir = &#39;../pseudo&#39;
prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
        nbnd = 35
/
&amp;ELECTRONS
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS crystal
          50
        0.5000000000    0.5000000000   -0.5000000000    1.0
        0.4994075000    0.5005925000   -0.4428337500    1.0
        0.4988150000    0.5011850000   -0.3856675000    1.0
        0.4982225000    0.5017775000   -0.3285012500    1.0
        0.4976300000    0.5023700000   -0.2713350000    1.0
        0.4970375000    0.5029625000   -0.2141687500    1.0
        0.4964450000    0.5035550000   -0.1570025000    1.0
        0.4958525000    0.5041475000   -0.0998362500    1.0
        0.4952600000    0.5047400000   -0.0426700000    1.0
        0.5337666667    0.4662333333   -0.0811750000    1.0
        0.5722733333    0.4277266667   -0.1196800000    1.0
        0.6107800000    0.3892200000   -0.1581850000    1.0
        0.6492866667    0.3507133333   -0.1966900000    1.0
        0.6877933333    0.3122066667   -0.2351950000    1.0
        0.7263000000    0.2737000000   -0.2737000000    1.0
        0.6810400000    0.3189600000   -0.3189600000    1.0
        0.6357800000    0.3642200000   -0.3642200000    1.0
        0.5905200000    0.4094800000   -0.4094800000    1.0
        0.5452600000    0.4547400000   -0.4547400000    1.0
        0.5000000000    0.5000000000   -0.5000000000    1.0
        0.3333333333    0.3333333333   -0.3333333333    1.0
        0.1666666667    0.1666666667   -0.1666666667    1.0
        0.0000000000    0.0000000000    0.0000000000    1.0
        0.0000000000    0.0000000000    0.0625000000    1.0
        0.0000000000    0.0000000000    0.1250000000    1.0
        0.0000000000    0.0000000000    0.1875000000    1.0
        0.0000000000    0.0000000000    0.2500000000    1.0
        0.0000000000    0.0000000000    0.3125000000    1.0
        0.0000000000    0.0000000000    0.3750000000    1.0
        0.0000000000    0.0000000000    0.4375000000    1.0
        0.0000000000    0.0000000000    0.5000000000    1.0
        0.0426700000   -0.0426700000    0.5047400000    1.0
        0.0811750000   -0.0811750000    0.4662333333    1.0
        0.1196800000   -0.1196800000    0.4277266667    1.0
        0.1581850000   -0.1581850000    0.3892200000    1.0
        0.1966900000   -0.1966900000    0.3507133333    1.0
        0.2351950000   -0.2351950000    0.3122066667    1.0
        0.2737000000   -0.2737000000    0.2737000000    1.0
        0.2280833333   -0.2280833333    0.2280833333    1.0
        0.1824666667   -0.1824666667    0.1824666667    1.0
        0.1368500000   -0.1368500000    0.1368500000    1.0
        0.0912333333   -0.0912333333    0.0912333333    1.0
        0.0456166667   -0.0456166667    0.0456166667    1.0
        0.0000000000    0.0000000000    0.0000000000    1.0
        0.0833333333    0.0000000000    0.0000000000    1.0
        0.1666666667    0.0000000000    0.0000000000    1.0
        0.2500000000    0.0000000000    0.0000000000    1.0
        0.3333333333    0.0000000000    0.0000000000    1.0
        0.4166666667    0.0000000000    0.0000000000    1.0
        0.5000000000    0.0000000000   -0.0000000000    1.0
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">pw.x</span></code>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in band.in
</pre></div>
</div>
<p><a class="reference download internal" download="" href="../_downloads/b1ec3039cdf0202e36301d36c1f37b1a/bands.in"><code class="xref download docutils literal notranslate"><span class="pre">bands.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;BANDS
      prefix = &#39;sr2cuo3&#39;
       lsym = .false.
/
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">bands.x</span></code> QuantumESPRESSO.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bands.x -in bands.in
</pre></div>
</div>
<p>We can plot the band structure by reading output <code class="docutils literal notranslate"><span class="pre">bands.out.gnu</span></code> from
GnuPlot etc.</p>
</section>
<section id="kohn-sham-orbitals-for-wannier">
<h2><span class="section-number">8.2.3. </span>Kohn-Sham orbitals for Wannier<a class="headerlink" href="#kohn-sham-orbitals-for-wannier" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/b593b96ec06a24a051e56aa0df84bd84/nscf.in"><code class="xref download docutils literal notranslate"><span class="pre">nscf.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;nscf&#39;
  pseudo_dir = &#39;../pseudo&#39;
  wf_collect = .true.
      prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
 occupations = &#39;tetrahedra_opt&#39;
        nbnd = 35
/
&amp;ELECTRONS
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS automatic
 4 4 4 0 0 0
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">pw.x</span></code> as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in nscf.in
</pre></div>
</div>
<p>Then, we use the utility <code class="docutils literal notranslate"><span class="pre">qe2respack.py</span></code> which is included in the RESPACK package.
The command-line argument is the name of <code class="docutils literal notranslate"><span class="pre">[prefix].save</span></code> directory.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qe2respack.py sr2cuo3.save
</pre></div>
</div>
</section>
<section id="wannier-function-dielectric-function-effective-interaction">
<h2><span class="section-number">8.2.4. </span>Wannier function, dielectric function, effective interaction<a class="headerlink" href="#wannier-function-dielectric-function-effective-interaction" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/b37127883768c5403e364998cb94cc7f/respack.in"><code class="xref download docutils literal notranslate"><span class="pre">respack.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;PARAM_CHIQW
Num_freq_grid = 1
!Ecut_for_eps = 
flg_cRPA = 1
/
&amp;PARAM_WANNIER
N_wannier = 1
Lower_energy_window = 8
Upper_energy_window = 13
N_initial_guess = 1
/
dx2 0.2 0.500000 0.000000 0.50000 0.0 0.0 1.0  0.0 1.0 0.0 1.0 0.0 0.0
&amp;PARAM_INTERPOLATION
N_sym_points = 10
!dense = 20, 24, 28
/
0.50000 0.50000 -0.50000
0.49526 0.50474 -0.04267
0.72630 0.27370 -0.27370
0.50000 0.50000 -0.50000
0.00000 0.00000 0.00000
0.00000 0.00000 0.50000
0.04267 -0.04267 0.50474
0.27370 -0.27370 0.27370
0.00000 0.00000 0.00000
0.50000 0.00000 0.00000
&amp;PARAM_VISUALIZATION
flg_vis_wannier = 1,
ix_vis_min = -1,
ix_vis_max = 2,
iy_vis_min = -1,
iy_vis_max = 1,
iz_vis_min = -1,
iz_vis_max = 2
/
&amp;PARAM_CALC_INT
calc_ifreq = 1
ix_intJ_min = -1
ix_intJ_max = 1
iy_intJ_min = -1
iy_intJ_max = 1
iz_intJ_min = -1
iz_intJ_max = 1
/
</pre></div>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">calc_wannier</span></code>, <code class="docutils literal notranslate"><span class="pre">calc_chiqw</span></code>, <code class="docutils literal notranslate"><span class="pre">calc_j3d</span></code>,
<code class="docutils literal notranslate"><span class="pre">calc_w3d</span></code> in RESPACK.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ calc_wannier &lt; respack.in
$ calc_chiqw &lt; respack.in
$ calc_w3d &lt; respack.in
$ calc_j3d &lt; respack.in
</pre></div>
</div>
<p>After finishing calculations, the files are outputted in <code class="docutils literal notranslate"><span class="pre">dir-model</span></code> folder.
The format of these files is Wannier90 format and the data such as the hopping integrals are written.
(If you use the old version of RESPACK (20190226), the folder name is  <code class="docutils literal notranslate"><span class="pre">dir-mvmc</span></code> .)</p>
</section>
<section id="quantum-lattice-mode-for-hphi-mvmc">
<h2><span class="section-number">8.2.5. </span>Quantum lattice mode for HPhi/mVMC<a class="headerlink" href="#quantum-lattice-mode-for-hphi-mvmc" title="Permalink to this heading">¶</a></h2>
<p>Using standard mode of HPhi/mVMC, the calculation will be done by reading the files in <code class="docutils literal notranslate"><span class="pre">dir-model</span></code> folder.
First, the files in <code class="docutils literal notranslate"><span class="pre">dir-model</span></code> directory should be moved to the current directry.
Then, the calculation will be started by using standard mode.
For example, in HPhi, the calculation will be dobe by typing the following command:</p>
<p><a class="reference download internal" download="" href="../_downloads/2230fa7451cede3854a6deef75032ce9/stan.in"><code class="xref download docutils literal notranslate"><span class="pre">stan.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model = &quot;Hubbard&quot;
lattice = &quot;wannier90&quot;
a0w = 8
a0l = 0
a0h = 8
a1w = 0
a1l = 1
a1h = 0
a2w = 1
a2l = 0
a2h = 0
method = &quot;TPQ&quot;
nelec = 8
exct = 1
cutoff_t = 0.5
cutoff_u = 1.0
cutoff_j = 0.02
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cp ./dir-model/* .
$ HPhi -s stan.in
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_HPhi.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction_en.html">1. What is <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse/ho-index.html">2. How to use <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tu-index.html">3. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filespecification/fi-index.html">4. File specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm/al-index.html">5. Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement_en.html">6. Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier/index.html">7. HPhi/mVMC Fourier-Transformation utility</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">8. Downfolding with Wannier functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">8.1. Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8.2. Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scf-calculation-of-charge-density">8.2.1. SCF calculation of charge density</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional-band-structure">8.2.2. (Optional) Band structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kohn-sham-orbitals-for-wannier">8.2.3. Kohn-Sham orbitals for Wannier</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wannier-function-dielectric-function-effective-interaction">8.2.4. Wannier function, dielectric function, effective interaction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#quantum-lattice-mode-for-hphi-mvmc">8.2.5. Quantum lattice mode for HPhi/mVMC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html">8.3. Input parameters for Standard mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html">8.4. File format</a></li>
<li class="toctree-l2"><a class="reference internal" href="contact.html">8.5. Contact</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html"><span class="section-number">8. </span>Downfolding with Wannier functions</a><ul>
      <li>Previous: <a href="overview.html" title="previous chapter"><span class="section-number">8.1. </span>Overview</a></li>
      <li>Next: <a href="parameter.html" title="next chapter"><span class="section-number">8.3. </span>Input parameters for Standard mode</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/wannier/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>