
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>5.3. Finite-temperature calculations by the TPQ method &#8212; HΦ Documentation 3.5.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.4. Dynamical Green’s function" href="DynamicalGreen_en.html" />
    <link rel="prev" title="5.2. Full Diagonalization method" href="FullDiagonalization_en.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="finite-temperature-calculations-by-the-tpq-method">
<h1><span class="section-number">5.3. </span>Finite-temperature calculations by the TPQ method<a class="headerlink" href="#finite-temperature-calculations-by-the-tpq-method" title="Permalink to this heading">¶</a></h1>
<p>Sugiura and Shimizu showed that
it is possible to calculate the finite-temperature properties
from a few wavefunctions (in the thermodynamic limit, only one wave function is necessary) <a class="footnote-reference brackets" href="#id6" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, <a class="footnote-reference brackets" href="#id7" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> .
The wavefunction is called the thermal pure quantum (TPQ) state.
Because the TPQ state can be generated by operating the Hamiltonian
to the random initial wavefunction,
we directly use the routine Lanczos method for the TPQ calculations.
The TPQ state is given by</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-0">
<span class="eqno">(5.9)<a class="headerlink" href="#equation-algorithm-tpq-en-0" title="Permalink to this equation">¶</a></span>\[|\Phi(\beta)\rangle\equiv\exp(-\frac{\beta\hat{\mathcal H}}{2})|\Phi_{\rm rand}\rangle.\]</div>
<p>Here,  <span class="math notranslate nohighlight">\(\beta\)</span> represents inverse temperature and <span class="math notranslate nohighlight">\(|\Phi_{\rm rand}\rangle\)</span>
is a random initial vector.
It is shown that it is possible to
calculate physical quantities at inverse temperature  <span class="math notranslate nohighlight">\(\beta\)</span>
as expectation values with respect to <span class="math notranslate nohighlight">\(|\Phi(\beta)\rangle\)</span>.</p>
<section id="details-of-implementation">
<h2><span class="section-number">5.3.1. </span>Details of implementation<a class="headerlink" href="#details-of-implementation" title="Permalink to this heading">¶</a></h2>
<section id="construction-of-the-micro-canonical-tpq-mtpq-state">
<h3><strong>Construction of the micro canonical TPQ (mTPQ) state</strong><a class="headerlink" href="#construction-of-the-micro-canonical-tpq-mtpq-state" title="Permalink to this heading">¶</a></h3>
<p>Here, we explain how to construct the micro canonical TPQ (mTPQ) state <a class="footnote-reference brackets" href="#id6" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>,
which offers the simplest method for calculating finite-temperature properties.</p>
<p>Let <span class="math notranslate nohighlight">\(|\Phi_{\rm rand}\rangle\)</span> be a random initial vector.
By operating <span class="math notranslate nohighlight">\((l-\hat{\mathcal H }/N_{s})^{k}\)</span>(<span class="math notranslate nohighlight">\(l\)</span> is constant and <span class="math notranslate nohighlight">\(N_{s}\)</span> represents the number of sites)
to <span class="math notranslate nohighlight">\(|\Phi_{\rm rand}\rangle\)</span>,
we obtain the <span class="math notranslate nohighlight">\(k\)</span>th TPQ states as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-1">
<span class="eqno">(5.10)<a class="headerlink" href="#equation-algorithm-tpq-en-1" title="Permalink to this equation">¶</a></span>\[|\Phi_{k}\rangle \equiv \frac{(l-\hat{\mathcal H }/N_{s})|\Phi_{k-1}\rangle}{|(l-\hat{\mathcal H }/N_{s})|\Phi_{k-1}\rangle}.\]</div>
<p>From <span class="math notranslate nohighlight">\(|\Phi_{k}\rangle\)</span>, we estimate the corresponding inverse temperature <span class="math notranslate nohighlight">\(\beta_{k}\)</span> as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-2">
<span class="eqno">(5.11)<a class="headerlink" href="#equation-algorithm-tpq-en-2" title="Permalink to this equation">¶</a></span>\[\beta_{k}\sim \frac{2k/N_{s}}{l-u_{k}}, u_{k} = \langle \Phi_{k}|\hat{\mathcal H }|\Phi_{k}\rangle/N_{s},\]</div>
<p>where <span class="math notranslate nohighlight">\(u_{k}\)</span> is the internal energy.
The arbitrary local physical properties at <span class="math notranslate nohighlight">\(\beta_{k}\)</span> are also estimated as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-3">
<span class="eqno">(5.12)<a class="headerlink" href="#equation-algorithm-tpq-en-3" title="Permalink to this equation">¶</a></span>\[\langle \hat{A}\rangle_{\beta_{k}} =  \langle \Phi_{k}|\hat{A}|\Phi_{k}\rangle.\]</div>
<p>In a finite-size system,
error is caused by the choice of the initial random vector.
To estimate the average value and error of the physical properties,
we perform some independent calculations by changing <span class="math notranslate nohighlight">\(|\Phi_{\rm rand}\rangle\)</span>.
Since the temperature</p>
</section>
<section id="construction-of-the-canonical-tpq-ctpq-state">
<h3><strong>Construction of the canonical TPQ (cTPQ) state</strong><a class="headerlink" href="#construction-of-the-canonical-tpq-ctpq-state" title="Permalink to this heading">¶</a></h3>
<p>Here, we explain how to construct the canonical TPQ (cTPQ) state <a class="footnote-reference brackets" href="#id7" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>,
which is another way to construct the TPQ state.
In the cTPQ method, <span class="math notranslate nohighlight">\(\exp[-\beta\hat{\mathcal H}/2]\)</span> is
approximated as follows:</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-4">
<span class="eqno">(5.13)<a class="headerlink" href="#equation-algorithm-tpq-en-4" title="Permalink to this equation">¶</a></span>\[\begin{split}&amp;\exp(-\frac{\beta\hat{\mathcal H}}{2})|\Phi_{\rm rand}\rangle\sim|\Phi_{k}\rangle = U(\Delta\tau)^{k}|\Phi_{\rm rand}\rangle\\
&amp;U(\Delta\tau)=\sum_{n=0}^{n_{\rm max}}\frac{1}{n!}(-\frac{\Delta\tau}{2}\hat{\mathcal H})^{n}\\
&amp;\beta_{k}=k\Delta \tau\end{split}\]</div>
<p>As in the mTPQ method,
physical quantities are calculated as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-5">
<span class="eqno">(5.14)<a class="headerlink" href="#equation-algorithm-tpq-en-5" title="Permalink to this equation">¶</a></span>\[\langle \hat{A}\rangle_{\beta_{k}} =  \frac{\langle\Phi_{k}|\hat{A}|\Phi_{k}\rangle}{\langle\Phi_{k}|\Phi_{k}\rangle}.\]</div>
</section>
<section id="initial-vector">
<h3><strong>Initial vector</strong><a class="headerlink" href="#initial-vector" title="Permalink to this heading">¶</a></h3>
<p>For the TPQ method, the initial vector is given by using a random generator, i.e., the coefficients of all the components for the initial vector are given by random numbers. The seed is calculated as</p>
<div class="math notranslate nohighlight" id="equation-algorithm-tpq-en-6">
<span class="eqno">(5.15)<a class="headerlink" href="#equation-algorithm-tpq-en-6" title="Permalink to this equation">¶</a></span>\[123432+(n_{\rm run}+1)\times|r_s|+k_{\rm Thread}+N_{\rm Thread} \times k_{\rm Process},\]</div>
<p>where <span class="math notranslate nohighlight">\(r_s\)</span> is the number given by an input file and <span class="math notranslate nohighlight">\(n_{\rm run}\)</span> is the number of runs. <span class="math notranslate nohighlight">\(r_s\)</span> and the maximum value of <span class="math notranslate nohighlight">\(n_{\rm run}\)</span> are defined by <code class="docutils literal notranslate"><span class="pre">initial_iv</span></code> and <code class="docutils literal notranslate"><span class="pre">NumAve</span></code> in an input file for Standard mode or a ModPara file for Expert mode, respectively. Random numbers are generated by using SIMD-oriented Fast Mersenne Twister (dSFMT) <a class="footnote-reference brackets" href="#id8" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> . We can select the type of initial vector as a real number or complex number by using <code class="docutils literal notranslate"><span class="pre">InitialVecType</span></code> in a ModPara file.
<span class="math notranslate nohighlight">\(k_{\rm Thread}, N_{\rm Thread},\)</span>
and <span class="math notranslate nohighlight">\(k_{\rm Process}\)</span> indicate
the thread ID, number of threads, process ID, respectively;
the initial vector depends both on <code class="docutils literal notranslate"><span class="pre">initial_iv</span></code> and the number of parallelisms.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>S. Sugiura and A. Shimizu, Phys. Rev. Lett. <strong>108</strong>, 240401 (2012).</p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>S. Sugiura and A. Shimizu, Phys. Rev. Lett. <strong>111</strong>, 010401 (2013).</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">3</a><span class="fn-bracket">]</span></span>
<p>http://www.math.sci.hiroshima-u.ac.jp/m-mat/MT/SFMT.</p>
</aside>
</aside>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_HPhi.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction_en.html">1. What is <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse/ho-index.html">2. How to use <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tu-index.html">3. Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filespecification/fi-index.html">4. File specification</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="al-index.html">5. Algorithm</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Lanczos_en.html">5.1. Lanczos method</a></li>
<li class="toctree-l2"><a class="reference internal" href="FullDiagonalization_en.html">5.2. Full Diagonalization method</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.3. Finite-temperature calculations by the TPQ method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#details-of-implementation">5.3.1. Details of implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DynamicalGreen_en.html">5.4. Dynamical Green’s function</a></li>
<li class="toctree-l2"><a class="reference internal" href="Realtime_en.html">5.5. Real time evolution method</a></li>
<li class="toctree-l2"><a class="reference internal" href="Bogoliubov_en.html">5.6. Bogoliubov representation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement_en.html">6. Acknowledgement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier/index.html">7. HPhi/mVMC Fourier-Transformation utility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wannier/index.html">8. Downfolding with Wannier functions</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="al-index.html"><span class="section-number">5. </span>Algorithm</a><ul>
      <li>Previous: <a href="FullDiagonalization_en.html" title="previous chapter"><span class="section-number">5.2. </span>Full Diagonalization method</a></li>
      <li>Next: <a href="DynamicalGreen_en.html" title="next chapter"><span class="section-number">5.4. </span>Dynamical Green’s function</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/algorithm/TPQ_en.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>