
<!DOCTYPE html>

<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8.2. チュートリアル &#8212; HΦ マニュアル 3.5.1 ドキュメント</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="next" title="8.3. スタンダードモードの入力パラメーター" href="parameter.html" />
    <link rel="prev" title="8.1. 概要" href="overview.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorialwannier">
<span id="id1"></span><h1><span class="section-number">8.2. </span>チュートリアル<a class="headerlink" href="#tutorialwannier" title="Permalink to this heading">¶</a></h1>
<p>このチュートリアルでは Sr<sub>2</sub>CuO<sub>3</sub> を例に,
1次元1軌道Hubbardモデルにダウンフォールドし,
HPhi/mVMCで計算するまでの一連の流れを示す.
DFT計算はQuantumESPRESSOで行う.
入力ファイルは <code class="docutils literal notranslate"><span class="pre">samples/Wannier/Sr2CuO3</span></code> ディレクトリにある.</p>
<p>なお, 実際の研究では必要に応じ, 各ソルバーの入力ファイル等を調整する.
入力ファイルの詳細については, 各ソルバーのマニュアルを参考にすること.</p>
<section id="scf">
<h2><span class="section-number">8.2.1. </span>電荷密度のSCF計算<a class="headerlink" href="#scf" title="Permalink to this heading">¶</a></h2>
<p>まず, DFTによる電荷密度のSCF計算を行う.</p>
<p><a class="reference download internal" download="" href="../_downloads/fc8a03ca4d72a607207c9c468c338dd3/scf.in"><code class="xref download docutils literal notranslate"><span class="pre">scf.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;scf&#39;
  pseudo_dir = &#39;../pseudo&#39;
prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
 occupations = &#39;tetrahedra_opt&#39;
/
&amp;ELECTRONS
mixing_beta = 0.3
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS automatic
 4 4 4 0 0 0
</pre></div>
</div>
<p>擬ポテンシャル (UPF ファイル) は
<a class="reference external" href="www.quantum-simulation.org/potentials/sg15_oncv/">The SG15 Optimized Norm-Conserving Vanderbilt (ONCV) pseudopotentials</a> のものを使う.
実行ディレクトリの直上に <code class="docutils literal notranslate"><span class="pre">pseudo</span></code> ディレクトリを作成して, そこに収める.</p>
<p><a class="reference external" href="http://www.quantum-simulation.org/potentials/sg15_oncv/sg15_oncv_upf_2015-10-07.tar.gz">http://www.quantum-simulation.org/potentials/sg15_oncv/sg15_oncv_upf_2015-10-07.tar.gz</a></p>
<p>SCF 計算には QuantumESPRESSO内のプログラム <code class="docutils literal notranslate"><span class="pre">pw.x</span></code> を使う.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in scf.in
</pre></div>
</div>
</section>
<section id="optional">
<h2><span class="section-number">8.2.2. </span>(Optional) バンド計算と描画<a class="headerlink" href="#optional" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/da167c3c214ea2b40788f448a3605d0b/band.in"><code class="xref download docutils literal notranslate"><span class="pre">band.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;bands&#39;
  pseudo_dir = &#39;../pseudo&#39;
prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
        nbnd = 35
/
&amp;ELECTRONS
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS crystal
          50
        0.5000000000    0.5000000000   -0.5000000000    1.0
        0.4994075000    0.5005925000   -0.4428337500    1.0
        0.4988150000    0.5011850000   -0.3856675000    1.0
        0.4982225000    0.5017775000   -0.3285012500    1.0
        0.4976300000    0.5023700000   -0.2713350000    1.0
        0.4970375000    0.5029625000   -0.2141687500    1.0
        0.4964450000    0.5035550000   -0.1570025000    1.0
        0.4958525000    0.5041475000   -0.0998362500    1.0
        0.4952600000    0.5047400000   -0.0426700000    1.0
        0.5337666667    0.4662333333   -0.0811750000    1.0
        0.5722733333    0.4277266667   -0.1196800000    1.0
        0.6107800000    0.3892200000   -0.1581850000    1.0
        0.6492866667    0.3507133333   -0.1966900000    1.0
        0.6877933333    0.3122066667   -0.2351950000    1.0
        0.7263000000    0.2737000000   -0.2737000000    1.0
        0.6810400000    0.3189600000   -0.3189600000    1.0
        0.6357800000    0.3642200000   -0.3642200000    1.0
        0.5905200000    0.4094800000   -0.4094800000    1.0
        0.5452600000    0.4547400000   -0.4547400000    1.0
        0.5000000000    0.5000000000   -0.5000000000    1.0
        0.3333333333    0.3333333333   -0.3333333333    1.0
        0.1666666667    0.1666666667   -0.1666666667    1.0
        0.0000000000    0.0000000000    0.0000000000    1.0
        0.0000000000    0.0000000000    0.0625000000    1.0
        0.0000000000    0.0000000000    0.1250000000    1.0
        0.0000000000    0.0000000000    0.1875000000    1.0
        0.0000000000    0.0000000000    0.2500000000    1.0
        0.0000000000    0.0000000000    0.3125000000    1.0
        0.0000000000    0.0000000000    0.3750000000    1.0
        0.0000000000    0.0000000000    0.4375000000    1.0
        0.0000000000    0.0000000000    0.5000000000    1.0
        0.0426700000   -0.0426700000    0.5047400000    1.0
        0.0811750000   -0.0811750000    0.4662333333    1.0
        0.1196800000   -0.1196800000    0.4277266667    1.0
        0.1581850000   -0.1581850000    0.3892200000    1.0
        0.1966900000   -0.1966900000    0.3507133333    1.0
        0.2351950000   -0.2351950000    0.3122066667    1.0
        0.2737000000   -0.2737000000    0.2737000000    1.0
        0.2280833333   -0.2280833333    0.2280833333    1.0
        0.1824666667   -0.1824666667    0.1824666667    1.0
        0.1368500000   -0.1368500000    0.1368500000    1.0
        0.0912333333   -0.0912333333    0.0912333333    1.0
        0.0456166667   -0.0456166667    0.0456166667    1.0
        0.0000000000    0.0000000000    0.0000000000    1.0
        0.0833333333    0.0000000000    0.0000000000    1.0
        0.1666666667    0.0000000000    0.0000000000    1.0
        0.2500000000    0.0000000000    0.0000000000    1.0
        0.3333333333    0.0000000000    0.0000000000    1.0
        0.4166666667    0.0000000000    0.0000000000    1.0
        0.5000000000    0.0000000000   -0.0000000000    1.0
</pre></div>
</div>
<p>ここでも <code class="docutils literal notranslate"><span class="pre">pw.x</span></code> を使う.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in band.in
</pre></div>
</div>
<p><a class="reference download internal" download="" href="../_downloads/b1ec3039cdf0202e36301d36c1f37b1a/bands.in"><code class="xref download docutils literal notranslate"><span class="pre">bands.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;BANDS
      prefix = &#39;sr2cuo3&#39;
       lsym = .false.
/
</pre></div>
</div>
<p>QuantumESPRESSOの <code class="docutils literal notranslate"><span class="pre">bands.x</span></code> を使う.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ bands.x -in bands.in
</pre></div>
</div>
<p>出力された <code class="docutils literal notranslate"><span class="pre">bands.out.gnu</span></code> をGnuPlotなどで読み込んでバンドを描く.</p>
</section>
<section id="kohn-sham">
<h2><span class="section-number">8.2.3. </span>Kohn-Sham軌道の計算<a class="headerlink" href="#kohn-sham" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/b593b96ec06a24a051e56aa0df84bd84/nscf.in"><code class="xref download docutils literal notranslate"><span class="pre">nscf.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;CONTROL
 calculation = &#39;nscf&#39;
  pseudo_dir = &#39;../pseudo&#39;
  wf_collect = .true.
      prefix = &#39;sr2cuo3&#39;
/
&amp;SYSTEM
       ibrav = 0
         nat = 6
        ntyp = 3
     ecutwfc = 30.000000
     ecutrho = 240.000000
 occupations = &#39;tetrahedra_opt&#39;
        nbnd = 35
/
&amp;ELECTRONS
/
CELL_PARAMETERS angstrom
 -1.749305 1.955690 6.351200
 1.749305 -1.955690 6.351200
 1.749305 1.955690 -6.351200
ATOMIC_SPECIES
 Sr 87.620000 Sr_ONCV_PBE-1.0.upf
 Cu 63.546000 Cu_ONCV_PBE-1.0.upf
 O 15.999400 O_ONCV_PBE-1.0.upf
ATOMIC_POSITIONS crystal
 Sr 0.851940 0.351940 0.500000
 Sr 0.148060 0.648060 0.500000
 Cu 0.500000 0.000000 0.500000
 O 0.654110 0.154110 0.500000
 O 0.345890 0.845890 0.500000
 O 0.000000 0.000000 0.000000
K_POINTS automatic
 4 4 4 0 0 0
</pre></div>
</div>
<p>ここでも <code class="docutils literal notranslate"><span class="pre">pw.x</span></code> を使う.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ pw.x -in nscf.in
</pre></div>
</div>
<p>次にRESPACKに付属のユーティリティー <code class="docutils literal notranslate"><span class="pre">qe2respack.py</span></code> を使う.
引数は <code class="docutils literal notranslate"><span class="pre">[prefix].save</span></code> ディレクトリ名.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ qe2respack.py sr2cuo3.save
</pre></div>
</div>
</section>
<section id="wannier">
<h2><span class="section-number">8.2.4. </span>Wannier関数, 誘電関数, 有効相互作用の計算<a class="headerlink" href="#wannier" title="Permalink to this heading">¶</a></h2>
<p><a class="reference download internal" download="" href="../_downloads/b37127883768c5403e364998cb94cc7f/respack.in"><code class="xref download docutils literal notranslate"><span class="pre">respack.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&amp;PARAM_CHIQW
Num_freq_grid = 1
!Ecut_for_eps = 
flg_cRPA = 1
/
&amp;PARAM_WANNIER
N_wannier = 1
Lower_energy_window = 8
Upper_energy_window = 13
N_initial_guess = 1
/
dx2 0.2 0.500000 0.000000 0.50000 0.0 0.0 1.0  0.0 1.0 0.0 1.0 0.0 0.0
&amp;PARAM_INTERPOLATION
N_sym_points = 10
!dense = 20, 24, 28
/
0.50000 0.50000 -0.50000
0.49526 0.50474 -0.04267
0.72630 0.27370 -0.27370
0.50000 0.50000 -0.50000
0.00000 0.00000 0.00000
0.00000 0.00000 0.50000
0.04267 -0.04267 0.50474
0.27370 -0.27370 0.27370
0.00000 0.00000 0.00000
0.50000 0.00000 0.00000
&amp;PARAM_VISUALIZATION
flg_vis_wannier = 1,
ix_vis_min = -1,
ix_vis_max = 2,
iy_vis_min = -1,
iy_vis_max = 1,
iz_vis_min = -1,
iz_vis_max = 2
/
&amp;PARAM_CALC_INT
calc_ifreq = 1
ix_intJ_min = -1
ix_intJ_max = 1
iy_intJ_min = -1
iy_intJ_max = 1
iz_intJ_min = -1
iz_intJ_max = 1
/
</pre></div>
</div>
<p>RESPACKのプログラム <code class="docutils literal notranslate"><span class="pre">calc_wannier</span></code>, <code class="docutils literal notranslate"><span class="pre">calc_chiqw</span></code>, <code class="docutils literal notranslate"><span class="pre">calc_j3d</span></code>,
<code class="docutils literal notranslate"><span class="pre">calc_w3d</span></code> を使う.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ calc_wannier &lt; respack.in
$ calc_chiqw &lt; respack.in
$ calc_w3d &lt; respack.in
$ calc_j3d &lt; respack.in
</pre></div>
</div>
<p>これにより, RESPACKによって出力されたホッピング等のファイルが,
Wannier90の形式で <code class="docutils literal notranslate"><span class="pre">dir-model</span></code> ディレクトリに格納される.
(RESPACKのバージョン20190227 以前では,  <code class="docutils literal notranslate"><span class="pre">dir-mvmc</span></code> ディレクトリ)</p>
</section>
<section id="hphi-mvmc">
<h2><span class="section-number">8.2.5. </span>HPhi/mVMCによるモデル計算<a class="headerlink" href="#hphi-mvmc" title="Permalink to this heading">¶</a></h2>
<p>HPhi/mVMCのスタンダードモードを利用することで,
<code class="docutils literal notranslate"><span class="pre">dir-model</span></code> のファイルを読み込み該当したモデルの計算ができる.
最初に <code class="docutils literal notranslate"><span class="pre">dir-model</span></code> 以下のファイル一式を, 実行するディレクトリに移したあとに,
スタンダードモードで計算実行を行えばよい.
例えば, HPhiの場合は以下のコマンドを打つことで計算が実行される(mVMCでもほぼ同様).</p>
<p><a class="reference download internal" download="" href="../_downloads/2230fa7451cede3854a6deef75032ce9/stan.in"><code class="xref download docutils literal notranslate"><span class="pre">stan.in</span></code></a></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>model = &quot;Hubbard&quot;
lattice = &quot;wannier90&quot;
a0w = 8
a0l = 0
a0h = 8
a1w = 0
a1l = 1
a1h = 0
a2w = 1
a2l = 0
a2h = 0
method = &quot;TPQ&quot;
nelec = 8
exct = 1
cutoff_t = 0.5
cutoff_u = 1.0
cutoff_j = 0.02
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ cp ./dir-model/* .
$ HPhi -s stan.in
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_HPhi.png" alt="Logo"/>
    
  </a>
</p>








<h3>ナビゲーション</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction_ja.html">1. What is <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howtouse/ho-index.html">2. How to use <span class="math notranslate nohighlight">\({\mathcal H}\Phi\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/tu-index.html">3. チュートリアル</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filespecification/fi-index.html">4. ファイルフォーマット</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm/al-index.html">5. アルゴリズム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../acknowledgement_ja.html">6. 謝辞</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fourier/index.html">7. 相関関数のFourier変換ユーティリティー</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">8. Wannier関数を用いたダウンフォールディング</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">8.1. 概要</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">8.2. チュートリアル</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scf">8.2.1. 電荷密度のSCF計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#optional">8.2.2. (Optional) バンド計算と描画</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kohn-sham">8.2.3. Kohn-Sham軌道の計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wannier">8.2.4. Wannier関数, 誘電関数, 有効相互作用の計算</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hphi-mvmc">8.2.5. HPhi/mVMCによるモデル計算</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html">8.3. スタンダードモードの入力パラメーター</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html">8.4. ファイルフォーマット</a></li>
<li class="toctree-l2"><a class="reference internal" href="contact.html">8.5. Contact</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html"><span class="section-number">8. </span>Wannier関数を用いたダウンフォールディング</a><ul>
      <li>Previous: <a href="overview.html" title="前の章へ"><span class="section-number">8.1. </span>概要</a></li>
      <li>Next: <a href="parameter.html" title="次の章へ"><span class="section-number">8.3. </span>スタンダードモードの入力パラメーター</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, The University of Tokyo.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/wannier/tutorial.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>